import { Head, Appear } from "mdx-deck";
import Logo from "./assets/images/logos/rdc-icon.svg";
export { default as theme } from "./theme";
import { CodeSurfer } from "mdx-deck-code-surfer";
import ultramin from "prism-react-renderer/themes/ultramin";

<Logo />

# Lecture 7

Review of data fetching and component lifecycle

---

# Fetch

Send a network request to:

- Get some information from another service
- Give some information to another service

---

# Fetch: Example

```javascript
let response = await fetch("https://api.kanye.rest");
let responseJson = await response.json();
```

---

# Fetch: Example, in React

<div className="codesurfer">
  <CodeSurfer
    theme={ultramin}
    code={require("!raw-loader!./assets/code/fetch_in_react.js")}
    lang="javascript"
    showNumbers={false}
    dark={false}
    steps={[
      { notes: "" },
      {
        notes:
          "We'll store a 'current' quote inside of state. It'll be empty at first!",
        lines: [4, 5, 6]
      },
      {
        notes:
          "That state variable will be rendered inside of our component, here",
        lines: [21]
      },
      {
        notes: "We have a button to fetch the quote",
        lines: [20]
      },
      {
        notes: "What does this.getQuote do?",
        lines: [20]
      },
      {
        notes:
          "Here's this.getQuote: it fetches from the Kanye West API and sets it into our state",
        lines: [9, 10, 11, 12, 13, 14, 15]
      },
      {
        notes: "This appears in our render function, from state!",
        lines: [21]
      },
      {}
    ]}
  />
</div>

---

# What about "before" the component loads?

How might we load an initial quote into the page, before a user clicks "Get quote"?

---

# Component Lifecycle

React has special method names that are called at certain points of a component's life

---

![](https://cdn-images-1.medium.com/max/1600/1*cPwvUhZrnB1dtZnjBEfXfA.png)

### Where to load the initial quote?

---

# Mounting and updating

- `componentDidMount`: The React component has been placed into the page
- `componentDidUpdate`: The newest render of the React component has been placed into the page

---

# The initial quote

<div className="codesurfer">
  <CodeSurfer
    theme={ultramin}
    code={require("!raw-loader!./assets/code/fetch_in_react2.js")}
    lang="javascript"
    showNumbers={false}
    dark={false}
    steps={[
      {},
      { notes: "This addition will load an initial quote", lines: [9, 10, 11] }
    ]}
  />
</div>

---

# When do we update?

A demo of the concepts we just reviewed

---

# Review

We had a `PokedexEntry` component:

```
<PokedexEntry name="ditto" />
<PokedexEntry name="abra" />
```

---

# Review

We had our `PokedexEntry` component receiving props from `App`'s state:

```jsx
<PokedexEntry name={this.state.currentPokemon} />
```

---

<div className="codesurfer">
  <CodeSurfer
    theme={ultramin}
    code={require("!raw-loader!./assets/code/fetch_in_react3.js")}
    lang="javascript"
    showNumbers={false}
    dark={false}
    steps={[
      {
        notes:
          "When the component first mounts, we fetch the Pokemon's info into state",
        lines: [25, 26, 27]
      },
      {
        notes:
          "Subsequently, when the component gets a different name prop, we fetch the Pokemon's info again",
        lines: [29, 30, 31, 32, 33]
      },
      {
        notes:
          "We only fetch again if the specific prop we use to identify Pokemon has changed",
        lines: [30, 31, 32]
      },
      {
        notes:
          "If this condition weren't here, this would cause infinite re-renders. componentDidUpdate happens after setState calls, too!",
        lines: [30, 31, 32]
      }
    ]}
  />
</div>
